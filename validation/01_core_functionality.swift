#!/usr/bin/env swift

/*
 éªŒè¯è„šæœ¬ 01: æ ¸å¿ƒåŠŸèƒ½éªŒè¯
 
 éªŒè¯å†…å®¹ï¼š
 - DeepSeek Provider åŸºç¡€å¯¹è¯
 - æµå¼å“åº”åŠŸèƒ½
 - é”™è¯¯å¤„ç†å’Œé‡è¯•
 - Tokenç»Ÿè®¡å‡†ç¡®æ€§
 
 ä½¿ç”¨æ–¹æ³•ï¼š
 export DEEPSEEK_API_KEY='your-api-key'
 swift validation/01_core_functionality.swift
*/

import Foundation

// éœ€è¦åœ¨ Swift Package é¡¹ç›®ä¸­è¿è¡Œ
// é€šè¿‡ swift run -c release Validation01CoreFunctionality
// æˆ–å°†æ­¤æ–‡ä»¶é›†æˆåˆ° Package.swift ä¸­

print("=" * 70)
print("ğŸ§ª éªŒè¯è„šæœ¬ 01: DeepSeek æ ¸å¿ƒåŠŸèƒ½éªŒè¯")
print("=" * 70)
print()

// è·å– API Key
guard let apiKey = ProcessInfo.processInfo.environment["DEEPSEEK_API_KEY"], !apiKey.isEmpty else {
    print("âŒ é”™è¯¯: æœªè®¾ç½® DEEPSEEK_API_KEY ç¯å¢ƒå˜é‡")
    print("è¯·ä½¿ç”¨: export DEEPSEEK_API_KEY='your-api-key'")
    exit(1)
}

print("âœ… API Key å·²åŠ è½½: \(String(apiKey.prefix(10)))...")
print()

// ============================================================================
// æµ‹è¯• 1: åŸºç¡€å¯¹è¯
// ============================================================================

print("â”" * 70)
print("æµ‹è¯• 1: DeepSeek åŸºç¡€å¯¹è¯")
print("â”" * 70)

Task {
    do {
        // è¿™é‡Œéœ€è¦å®é™…å¯¼å…¥ SwiftAgent framework
        // æ³¨æ„ï¼šæ­¤è„šæœ¬éœ€è¦ä½œä¸º Swift Package çš„ä¸€éƒ¨åˆ†è¿è¡Œ
        // æˆ–è€…ç¼–è¯‘ä¸ºç‹¬ç«‹å¯æ‰§è¡Œæ–‡ä»¶
        
        print("ğŸ“ æç¤º: æ­¤éªŒè¯è„šæœ¬è®¾è®¡ä¸ºæ¡†æ¶çš„ä¸€éƒ¨åˆ†è¿è¡Œ")
        print("è¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š")
        print()
        print("  cd /path/to/swiftAgent")
        print("  export DEEPSEEK_API_KEY='your-key'")
        print("  swift test --filter DeepSeekIntegrationTests")
        print()
        print("æˆ–åˆ›å»ºä¸€ä¸ªä¸“é—¨çš„éªŒè¯ç›®æ ‡ï¼š")
        print()
        print("  swift run ValidationRunner --script 01_core_functionality")
        print()
        
        print("âœ… è„šæœ¬ç»“æ„éªŒè¯é€šè¿‡")
        print()
        
    } catch {
        print("âŒ æµ‹è¯•å¤±è´¥: \(error.localizedDescription)")
    }
}

// ============================================================================
// æµ‹è¯•è®¡åˆ’è¯´æ˜
// ============================================================================

print("â”" * 70)
print("ğŸ“‹ å®Œæ•´æµ‹è¯•è®¡åˆ’")
print("â”" * 70)
print()

let testPlan = """
## æ ¸å¿ƒåŠŸèƒ½éªŒè¯æµ‹è¯•è®¡åˆ’

### 1. åŸºç¡€å¯¹è¯æµ‹è¯•
   âœ“ å•è½®å¯¹è¯
   âœ“ å¤šè½®å¯¹è¯
   âœ“ ä¸Šä¸‹æ–‡ä¿æŒ
   âœ“ å“åº”è´¨é‡éªŒè¯

### 2. æµå¼å“åº”æµ‹è¯•
   âœ“ æµå¼æ•°æ®æ¥æ”¶
   âœ“ æ•°æ®å—å®Œæ•´æ€§
   âœ“ æœ€ç»ˆç»“æœä¸€è‡´æ€§
   âœ“ å›è°ƒå‡½æ•°æ­£ç¡®æ€§

### 3. Token ç»Ÿè®¡æµ‹è¯•
   âœ“ Prompt tokens å‡†ç¡®æ€§
   âœ“ Completion tokens å‡†ç¡®æ€§
   âœ“ Total tokens è®¡ç®—æ­£ç¡®

### 4. é”™è¯¯å¤„ç†æµ‹è¯•
   âœ“ æ— æ•ˆ API Key
   âœ“ ç½‘ç»œè¶…æ—¶
   âœ“ é€Ÿç‡é™åˆ¶
   âœ“ é‡è¯•æœºåˆ¶

### 5. æ€§èƒ½åŸºå‡†æµ‹è¯•
   âœ“ å“åº”æ—¶é—´ < 5ç§’
   âœ“ æµå¼é¦–å­—èŠ‚æ—¶é—´ < 2ç§’
   âœ“ å†…å­˜ä½¿ç”¨åˆç†
   âœ“ å¹¶å‘å¤„ç†èƒ½åŠ›

## éªŒè¯æ ‡å‡†

### âœ… é€šè¿‡æ ‡å‡†ï¼š
- æ‰€æœ‰å¯¹è¯è¯·æ±‚è¿”å›æœ‰æ•ˆå“åº”
- æµå¼å“åº”æ•°æ®å®Œæ•´æ— ä¸¢å¤±
- Token ç»Ÿè®¡è¯¯å·® < 5%
- é”™è¯¯å¤„ç†æ­£ç¡®ï¼Œæœ‰å‹å¥½æç¤º
- æ€§èƒ½ç¬¦åˆåŸºå‡†è¦æ±‚

### âŒ å¤±è´¥æ ‡å‡†ï¼š
- å¯¹è¯è¯·æ±‚å¤±è´¥æˆ–è¶…æ—¶
- æµå¼å“åº”æ•°æ®æŸå
- Token ç»Ÿè®¡é”™è¯¯ > 10%
- é”™è¯¯æœªæ­£ç¡®å¤„ç†æˆ–å¯¼è‡´å´©æºƒ
- æ€§èƒ½ä¸¥é‡ä½äºåŸºå‡†

## å®é™…éªŒè¯æ–¹æ³•

### æ–¹æ³• 1: ä½¿ç”¨é›†æˆæµ‹è¯•
```bash
cd swiftAgent
export DEEPSEEK_API_KEY='your-key'
swift test --filter DeepSeekIntegrationTests
```

### æ–¹æ³• 2: ä½¿ç”¨éªŒè¯ Package
åˆ›å»ºç‹¬ç«‹çš„éªŒè¯å¯æ‰§è¡Œæ–‡ä»¶ï¼š

1. åœ¨ Package.swift ä¸­æ·»åŠ ï¼š
```swift
.executableTarget(
    name: "ValidationRunner",
    dependencies: ["SwiftAgent"],
    path: "validation/Sources"
)
```

2. åˆ›å»ºéªŒè¯æºæ–‡ä»¶ç»“æ„ï¼š
```
validation/
  Sources/
    ValidationRunner/
      main.swift
      01_CoreFunctionality.swift
      02_AgentWorkflow.swift
      ...
```

3. è¿è¡ŒéªŒè¯ï¼š
```bash
swift run ValidationRunner
```

### æ–¹æ³• 3: æ‰‹åŠ¨éªŒè¯
ä½¿ç”¨ç¤ºä¾‹é¡¹ç›®è¿›è¡Œæ‰‹åŠ¨éªŒè¯ï¼š
```bash
cd Examples/DeepSeekExample
export DEEPSEEK_API_KEY='your-key'
swift run
```

## é¢„æœŸè¾“å‡º

### æˆåŠŸè¾“å‡ºç¤ºä¾‹ï¼š
```
==================================================
ğŸ§ª éªŒè¯è„šæœ¬ 01: DeepSeek æ ¸å¿ƒåŠŸèƒ½éªŒè¯
==================================================

âœ… API Key å·²åŠ è½½: sk-2393...

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æµ‹è¯• 1: DeepSeek åŸºç¡€å¯¹è¯
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“¤ å‘é€æ¶ˆæ¯: ä½ å¥½ï¼Œè¯·ä»‹ç»ä½ è‡ªå·±
â±ï¸  å“åº”æ—¶é—´: 1.23ç§’
ğŸ“ æ”¶åˆ°å“åº”: ä½ å¥½ï¼Œæˆ‘æ˜¯DeepSeek...
ğŸ“Š Tokenä½¿ç”¨: 40 tokens
âœ… åŸºç¡€å¯¹è¯æµ‹è¯•é€šè¿‡

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æµ‹è¯• 2: æµå¼å“åº”
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“¤ å‘é€æ¶ˆæ¯: å†™ä¸€ä¸ªç®€çŸ­çš„æ•…äº‹
ğŸ”„ æ¥æ”¶æµå¼æ•°æ®...
  ä½ 
  å¥½
  ï¼Œ
  è¿™
  æ˜¯
  ä¸€
  ä¸ª
  æ•…
  äº‹
  ...
âœ… æ”¶åˆ° 45 ä¸ªæ•°æ®å—
âœ… å®Œæ•´å†…å®¹é•¿åº¦: 127 å­—ç¬¦
âœ… æµå¼å“åº”æµ‹è¯•é€šè¿‡

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æµ‹è¯• 3: Token ç»Ÿè®¡
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“Š Prompt tokens: 15
ğŸ“Š Completion tokens: 25
ğŸ“Š Total tokens: 40
âœ… Token ç»Ÿè®¡éªŒè¯é€šè¿‡

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æµ‹è¯• 4: é”™è¯¯å¤„ç†
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ”„ æµ‹è¯•æ— æ•ˆ API Key...
âŒ é¢„æœŸé”™è¯¯: Invalid API Key
âœ… é”™è¯¯å¤„ç†æ­£ç¡®

ğŸ”„ æµ‹è¯•é‡è¯•æœºåˆ¶...
âš ï¸  ç¬¬ 1 æ¬¡å¤±è´¥ï¼Œé‡è¯•ä¸­...
âš ï¸  ç¬¬ 2 æ¬¡å¤±è´¥ï¼Œé‡è¯•ä¸­...
âœ… ç¬¬ 3 æ¬¡æˆåŠŸ
âœ… é‡è¯•æœºåˆ¶å·¥ä½œæ­£å¸¸

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
éªŒè¯æ€»ç»“
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… åŸºç¡€å¯¹è¯:          é€šè¿‡
âœ… æµå¼å“åº”:          é€šè¿‡
âœ… Token ç»Ÿè®¡:        é€šè¿‡
âœ… é”™è¯¯å¤„ç†:          é€šè¿‡
âœ… æ€§èƒ½åŸºå‡†:          é€šè¿‡ (å¹³å‡ 1.5ç§’)

ğŸ‰ æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½éªŒè¯é€šè¿‡ï¼

==================================================
```

## ä¸‹ä¸€æ­¥

éªŒè¯é€šè¿‡åï¼Œç»§ç»­æ‰§è¡Œï¼š
- validation/02_agent_workflow.swift
- validation/03_tools_system.swift
- validation/04_memory_system.swift
- validation/05_persistence.swift
- validation/06_performance.swift
- validation/07_multi_agent.swift
- validation/08_streaming.swift
"""

print(testPlan)
print()
print("=" * 70)
print("ğŸ“Œ æç¤º: æ­¤è„šæœ¬ä¸ºéªŒè¯è®¡åˆ’æ¨¡æ¿")
print("å®é™…éªŒè¯è¯·è¿è¡Œé›†æˆæµ‹è¯•æˆ–åˆ›å»ºéªŒè¯ Package")
print("=" * 70)

// è¿è¡Œäº‹ä»¶å¾ªç¯ä»¥ç­‰å¾…å¼‚æ­¥ä»»åŠ¡
RunLoop.main.run(until: Date(timeIntervalSinceNow: 0.1))
